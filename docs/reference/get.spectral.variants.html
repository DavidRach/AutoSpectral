<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Get Spectral Variations for Fluorophores — get.spectral.variants • AutoSpectral</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Get Spectral Variations for Fluorophores — get.spectral.variants"><meta property="og:description" content="This function cycles through all the fluorophores defined in control.def.file,
identifying variations in spectral profiles. It does this by performing SOM
clustering on the positive events in the cleaned control data. The output is
saved as an .rds file, and figures summarizing the variation are saved, if
desired. Note that the .rds file contains all the needed information for
downstream processing (per-cell unmixing), so you can just load that using
the readRDS function) rather than re-running this process."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">AutoSpectral</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Aurora_example.html">Aurora_example</a>
    </li>
    <li>
      <a href="../articles/Cleaning.html">Cleaning</a>
    </li>
    <li>
      <a href="../articles/Control_File_example.html">Control_File_example</a>
    </li>
    <li>
      <a href="../articles/Gating.html">Gating</a>
    </li>
    <li>
      <a href="../articles/Per_Cell_Optimization.html">Per Cell Optimization</a>
    </li>
    <li>
      <a href="../articles/Plotting.html">Plotting</a>
    </li>
    <li>
      <a href="../articles/Reload_AutoSpectral.html">Re-running_AutoSpectral</a>
    </li>
    <li>
      <a href="../articles/Single_Cell_AutoFluorescence.html">Single Cell Autofluorescence</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/DrCytometer/AutoSpectral/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Get Spectral Variations for Fluorophores</h1>
    <small class="dont-index">Source: <a href="https://github.com/DrCytometer/AutoSpectral/blob/HEAD/R/get_spectral_variants.R" class="external-link"><code>R/get_spectral_variants.R</code></a></small>
    <div class="hidden name"><code>get.spectral.variants.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function cycles through all the fluorophores defined in <code>control.def.file</code>,
identifying variations in spectral profiles. It does this by performing SOM
clustering on the positive events in the cleaned control data. The output is
saved as an .rds file, and figures summarizing the variation are saved, if
desired. Note that the .rds file contains all the needed information for
downstream processing (per-cell unmixing), so you can just load that using
the <code>readRDS</code> function) rather than re-running this process.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get.spectral.variants</span><span class="op">(</span></span>
<span>  <span class="va">control.dir</span>,</span>
<span>  <span class="va">control.def.file</span>,</span>
<span>  <span class="va">asp</span>,</span>
<span>  <span class="va">spectra</span>,</span>
<span>  <span class="va">af.spectra</span>,</span>
<span>  n.cells <span class="op">=</span> <span class="fl">2000</span>,</span>
<span>  pos.quantile <span class="op">=</span> <span class="fl">0.995</span>,</span>
<span>  som.dim <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  sim.threshold <span class="op">=</span> <span class="fl">0.98</span>,</span>
<span>  figures <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  output.dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-control-dir">control.dir<a class="anchor" aria-label="anchor" href="#arg-control-dir"></a></dt>
<dd><p>File path to the single-stained control FCS files.</p></dd>


<dt id="arg-control-def-file">control.def.file<a class="anchor" aria-label="anchor" href="#arg-control-def-file"></a></dt>
<dd><p>CSV file defining the single-color control file names,
fluorophores they represent, marker names, peak channels, and gating requirements.</p></dd>


<dt id="arg-asp">asp<a class="anchor" aria-label="anchor" href="#arg-asp"></a></dt>
<dd><p>The AutoSpectral parameter list.
Prepare using <code>get.autospectral.param</code></p></dd>


<dt id="arg-spectra">spectra<a class="anchor" aria-label="anchor" href="#arg-spectra"></a></dt>
<dd><p>A matrix containing the spectral data. Fluorophores in rows,
detectors in columns.</p></dd>


<dt id="arg-af-spectra">af.spectra<a class="anchor" aria-label="anchor" href="#arg-af-spectra"></a></dt>
<dd><p>Spectral signatures of autofluorescences, normalized
between 0 and 1, with fluorophores in rows and detectors in columns. Prepare
using <code>get.af.spectra</code>.</p></dd>


<dt id="arg-n-cells">n.cells<a class="anchor" aria-label="anchor" href="#arg-n-cells"></a></dt>
<dd><p>Numeric, default <code>2000</code>. Number of cells to use for defining
the variation in spectra. Up to <code>n.cells</code> cells will be selected as positive
events in the peak channel for each fluorophore, above the <code>pos.quantile</code> in
the unstained sample.</p></dd>


<dt id="arg-pos-quantile">pos.quantile<a class="anchor" aria-label="anchor" href="#arg-pos-quantile"></a></dt>
<dd><p>Numeric, default <code>0.995</code>. Threshold for positivity. This
quantile will be used to define the maximum extent of the unstained sample in
the unmixed space. Anything above that will be considered positive in the
single-stained controls.</p></dd>


<dt id="arg-som-dim">som.dim<a class="anchor" aria-label="anchor" href="#arg-som-dim"></a></dt>
<dd><p>Numeric, default <code>10</code>. Number of x and y dimensions to use in
the SOM for clustering the spectral variation.</p></dd>


<dt id="arg-sim-threshold">sim.threshold<a class="anchor" aria-label="anchor" href="#arg-sim-threshold"></a></dt>
<dd><p>Numeric, default <code>0.98</code>. Threshold for cosine similarity-
based exclusion of spectral variants. Any variant less than <code>sim.threshold</code>
by <code>cosine.similarity</code> from the optimized spectrum for that fluorophore (from
<code>spectra</code>) will be excluded from output. This helps to exclude autofluorescence
contamination.</p></dd>


<dt id="arg-figures">figures<a class="anchor" aria-label="anchor" href="#arg-figures"></a></dt>
<dd><p>Logical, controls whether the variation in spectra for each
fluorophore is plotted in <code>output.dir</code>. Default is <code>TRUE</code>.</p></dd>


<dt id="arg-output-dir">output.dir<a class="anchor" aria-label="anchor" href="#arg-output-dir"></a></dt>
<dd><p>File path to whether the figures and .rds data file will be
saved. Default is <code>NULL</code>, in which case <code>asp$variant.dir</code> will be used.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Logical, default is <code>FALSE</code>, in which case sequential processing
will be used. Parallel processing will likely be faster when many small
files are read in. If the data is larger, parallel processing may not
accelerate the process much or may fail outright.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical, default is <code>TRUE</code>. Set to <code>FALSE</code> to suppress messages.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A vector with the indexes of events inside the initial gate.</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Oliver Burton, Carlos P. Roca.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

